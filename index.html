<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³•å¾‹é¡§å•å›è¦†ç³»çµ±</title>
    <link rel="stylesheet" href="style.css?v=2.0">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a3b5d">
    <link rel="apple-touch-icon" href="icon.png"> 
<style>
 :root {
    --primary-color: #1a3b5d; /* å°ˆæ¥­æ·±è— */
    --accent-color: #3498db;
    --text-color: #2c3e50;
    --bg-color: #f0f2f5;
    --paper-bg: #ffffff;
    --border-color: #e0e0e0;
    
    /* è¢å¹•é¡¯ç¤ºç”¨çš„å­—é«”å¤§å° (æ¯”åˆ—å°ç¨å¤§ä»¥åˆ©é–±è®€) */
    --font-size-body: 1.1rem; 
    --font-size-title: 1.3rem;
}

body {
    font-family: "PingFang TC", "Microsoft JhengHei", "Noto Sans TC", sans-serif;
    background-color: var(--bg-color);
    margin: 0;
    padding: 0;
    color: var(--text-color);
    line-height: 1.6;
    font-size: var(--font-size-body);
}

/* --- é ‚éƒ¨ Header & Logo --- */
.app-header {
    background: var(--primary-color);
    color: white;
    padding: 10px 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    position: sticky; /* è®“æ¨™é¡Œåˆ—å¸é™„åœ¨é ‚éƒ¨ */
    top: 0;
    z-index: 1000;
}
.brand-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    max-width: 210mm;
    margin: 0 auto;
}
.header-logo {
    height: 45px; /* Logo é«˜åº¦ */
    width: auto;
    background: white; 
    padding: 2px;
    border-radius: 4px;
}
.app-header h1 {
    margin: 0;
    font-size: 1.2rem;
    font-weight: 500;
    letter-spacing: 1px;
}

/* --- ç´™å¼µå®¹å™¨ (A4 è³ªæ„Ÿ) --- */
.paper-container {
    padding: 20px;
    padding-bottom: 100px; /* é ç•™åº•éƒ¨æŒ‰éˆ•ç©ºé–“ */
    display: flex;
    justify-content: center;
}
.paper {
    background: var(--paper-bg);
    width: 100%;
    max-width: 210mm; /* A4 æ¨™æº–å¯¬ */
    min-height: 297mm;
    padding: 25mm 20mm; /* æ¨™æº–å…¬æ–‡é‚Šè· */
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    border-radius: 4px;
    box-sizing: border-box;
}

/* --- æª”é ­å°é½Šæ ¸å¿ƒè¨­å®š (é—œéµ) --- */
.header-info {
    margin-bottom: 40px;
}
.form-group {
    margin-bottom: 15px;
    display: flex;
    align-items: center;
}
/* è®“æ¨™ç±¤æ–‡å­—åˆ†æ•£å°é½Š (ä¾‹å¦‚ï¼šæ¡ˆç”± vs å›è¦†æ—¥æœŸ) */
.form-group label {
    width: 5em; /* å›ºå®šå¯¬åº¦ (ç´„4å€‹å­—å¯¬) */
    text-align: justify;
    text-align-last: justify; /* å¼·åˆ¶åˆ†æ•£å°é½Š */
    font-weight: 700;
    color: var(--text-color);
    margin-right: 5px; /* æ¨™ç±¤èˆ‡å†’è™Ÿçš„è·é›¢ */
}
.colon {
    font-weight: 700;
    margin-right: 1em; /* å†’è™Ÿèˆ‡è¼¸å…¥æ¡†çš„è·é›¢ï¼šä¸€å€‹ä¸­æ–‡å­—å¯¬ */
}
/* æ—¥æœŸè¼¸å…¥æ¡†ä¸æ›è¡Œ */
input[type="date"] {
    max-width: 200px;
}

/* --- é€šç”¨è¼¸å…¥æ¡†æ¨£å¼ --- */
input, textarea {
    flex: 1; /* ä½”æ»¿å‰©é¤˜ç©ºé–“ */
    border: none;
    border-bottom: 1px solid var(--border-color);
    padding: 8px 0;
    font-family: inherit;
    font-size: inherit;
    color: #000;
    background: transparent;
    outline: none;
    resize: none;
    transition: border 0.3s;
}
input:focus, textarea:focus {
    border-bottom: 2px solid var(--primary-color);
    background-color: rgba(26, 59, 93, 0.02);
}

/* åˆ†éš”ç·š */
.divider {
    border: 0;
    border-top: 1px solid #ccc;
    margin: 20px 0 35px 0;
}

/* --- å€å¡Šèˆ‡æ¨™é¡Œ --- */
.section {
    margin-bottom: 35px;
}
.section-title {
    font-size: var(--font-size-title);
    color: var(--primary-color);
    margin-bottom: 15px;
    font-weight: 700;
    border-left: 5px solid var(--primary-color); /* å·¦å´è—æ¢ */
    padding-left: 10px; /* æ¨™é¡Œæ–‡å­—ç¸®æ’ */
    line-height: 1.2;
}
/* å…§å®¹ç¸®æ’ï¼šè®“å…§å®¹å°é½Šæ¨™é¡Œæ–‡å­—çš„èµ·å§‹é» */
.content-wrapper {
    padding-left: 18px; /* èª¿æ•´æ­¤æ•¸å€¼ä»¥å°é½Šæ¨™é¡Œæ–‡å­— */
}

/* --- æ³•å¾‹ä¾æ“šé›™æ¬„ --- */
.legal-basis-row {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
    align-items: flex-start;
}
.basis-col-title { flex: 3; }
.basis-col-content { flex: 7; }
.basis-input-title {
    font-weight: 600;
    color: var(--primary-color);
}

/* --- åœ–ç‰‡ä¸Šå‚³å€ --- */
.image-upload-area {
    margin-top: 20px;
    border: 1px dashed #ccc;
    padding: 15px;
    border-radius: 6px;
    background: #fafafa;
}
.image-preview-box img {
    max-width: 100%;
    margin-top: 10px;
    border: 1px solid #ddd;
}
.upload-hint {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 10px;
}

/* --- åº•éƒ¨æŒ‰éˆ• --- */
.action-bar {
    position: fixed;
    bottom: 0; left: 0; width: 100%;
    background: rgba(255,255,255,0.95);
    padding: 15px;
    box-shadow: 0 -4px 10px rgba(0,0,0,0.1);
    display: flex;
    justify-content: center;
    gap: 20px;
    z-index: 2000;
}
button {
    border: none;
    padding: 10px 24px;
    border-radius: 50px;
    font-size: 1rem;
    cursor: pointer;
    font-weight: 500;
}
.btn-primary { background: var(--primary-color); color: white; }
.btn-secondary { background: white; border: 1px solid #ccc; color: var(--text-color); }
.btn-add { 
    background: transparent; 
    color: var(--accent-color); 
    border: 1px dashed var(--accent-color); 
    border-radius: 4px; 
    padding: 5px 15px; 
}

/* --- é å°¾ --- */
.footer-note {
    margin-top: 50px;
    text-align: center;
    font-size: 0.8rem;
    color: #999;
}

/* --- åˆ—å°å°ˆç”¨è¨­å®š (åš´æ ¼æ§åˆ¶æ ¼å¼) --- */
@media print {
    @page { margin: 15mm 20mm; size: A4; }
    
    body {
        background: white;
        font-size: 12pt !important; /* æœ¬æ–‡å¼·åˆ¶ 12pt */
        color: black;
    }
    
    .paper-container, .paper {
        display: block;
        width: 100%;
        max-width: 100%;
        box-shadow: none;
        padding: 0;
        margin: 0;
    }
    
    .no-print { display: none !important; }
    
    /* æ¨™é¡Œå¼·åˆ¶ 14pt */
    .section-title {
        font-size: 14pt !important;
        color: black !important;
        border-left: 5px solid #000; /* åˆ—å°æ™‚è—æ¢è®Šé»‘æ¢ï¼Œæ›´æ¸…æ™° */
    }
    .basis-input-title { color: black !important; }
    
    /* ç§»é™¤æ‰€æœ‰è¼¸å…¥æ¡†åº•ç·šï¼Œåƒä¸€èˆ¬æ–‡ä»¶ */
    input, textarea {
        border-bottom: none !important;
        padding: 0;
        resize: none;
    }
    
    /* éš±è— placeholder */
    ::placeholder { color: transparent; }
    
    /* ç¢ºä¿åœ–ç‰‡åˆ—å° */
    .image-upload-area {
        border: none;
        background: none;
        padding: 0;
    }
    
    /* ç¢ºä¿è¡¨é ­æ¨™ç±¤å¯¬åº¦æ­£ç¢º */
    .form-group label {
        width: 5em;
        text-align-last: justify;
    }
}       
    </style>

</head>
<body> 
	<script> 
	// 1. è¨­å®šé è¨­æ—¥æœŸç‚ºä»Šæ—¥
document.getElementById('dateInput').valueAsDate = new Date();

// 2. æ–‡å­—æ¡†è‡ªå‹•èª¿æ•´é«˜åº¦ (Auto-resize)
function autoResize(element) {
    element.style.height = 'auto';
    element.style.height = element.scrollHeight + 'px';
}

// 3. æ–°å¢æ³•æ¢æ¬„ä½
function addLegalBasis() {
    const container = document.getElementById('legalBasisContainer');
    const newRow = document.createElement('div');
    newRow.className = 'legal-basis-row';
    newRow.innerHTML = `
        <div class="basis-col-title">
            <input type="text" placeholder="æ³•å¾‹åç¨±/æ¢è™Ÿ" class="basis-input-title">
        </div>
        <div class="basis-col-content">
            <textarea placeholder="æ¢æ–‡å…§å®¹..." oninput="autoResize(this)"></textarea>
        </div>
    `;
    container.appendChild(newRow);
}

// 4. åœ–ç‰‡é è¦½åŠŸèƒ½
function previewImage(input) {
    const container = document.getElementById('imagePreviewContainer');
    container.innerHTML = ''; // æ¸…ç©ºèˆŠåœ–

    if (input.files && input.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const img = document.createElement('img');
            img.src = e.target.result;
            // é»æ“Šåœ–ç‰‡å¯ç§»é™¤ (æ–¹ä¾¿æ“ä½œ)
            img.onclick = function() {
                if(confirm('è¦ç§»é™¤é€™å¼µåœ–ç‰‡å—ï¼Ÿ')) {
                    container.innerHTML = '';
                    input.value = ''; // æ¸…ç©º input
                }
            };
            img.title = "é»æ“Šå¯ç§»é™¤åœ–ç‰‡";
            container.appendChild(img);
        }
        
        reader.readAsDataURL(input.files[0]);
    }
}

// 5. è™•ç†åˆ—å°
function handlePrint() {
    window.print();
}

// 6. è™•ç†åˆ†äº«
function handleShare() {
    const company = document.getElementById('companyName').value;
    const subject = document.getElementById('caseSubject').value;
    const response = document.getElementById('lawyerResponse').value;
    
    const textToShare = `ã€å¾‹å¸«å›è¦†ã€‘\nå—æ–‡è€…ï¼š${company}\næ¡ˆç”±ï¼š${subject}\n\nå›è¦†é‡é»ï¼š\n${response}`;

    if (navigator.share) {
        navigator.share({
            title: 'æ³•å¾‹é¡§å•å›è¦†',
            text: textToShare,
        }).catch(console.error);
    } else {
        navigator.clipboard.writeText(textToShare).then(() => {
            alert("æ–‡å­—å…§å®¹å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼");
        });
    }
}
	</script> 
</body>

<header class="app-header no-print">
    <div class="brand-container">
        <img src="logo.png" alt="Logo" class="header-logo">
        <h1>æ³•å¾‹é¡§å•å›è¦†åŠ©æ‰‹</h1>
    </div>
</header>

<div class="paper-container">
    <div class="paper">
        <form id="legalForm">
            <div class="header-info">
                <div class="form-group">
                    <label>å›è¦†æ—¥æœŸ</label>
                    <span class="colon">ï¼š</span>
                    <input type="date" id="dateInput">
                </div>
                
                <div class="form-group">
                    <label>å—æ–‡è€…</label>
                    <span class="colon">ï¼š</span>
                    <input type="text" id="companyName" placeholder="è«‹è¼¸å…¥é¡§å•å…¬å¸åç¨±" class="input-lg">
                </div>

                <div class="form-group">
                    <label>æ¡ˆç”±</label>
                    <span class="colon">ï¼š</span>
                    <input type="text" id="caseSubject" placeholder="è«‹è¼¸å…¥æ¡ˆç”±" class="input-lg">
                </div>
            </div>

            <hr class="divider">

            <div class="section">
                <h3 class="section-title">ä¸€ã€æ³•å¾‹å•é¡Œ</h3>
                <div class="content-wrapper">
                    <textarea id="question" placeholder="è«‹ç´€éŒ„é¡§å•å…¬å¸æå‡ºä¹‹å•é¡Œ..." oninput="autoResize(this)"></textarea>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title">äºŒã€å•é¡Œæ‰€æ¶‰æ–‡ä»¶</h3>
                <div class="content-wrapper">
                    <textarea id="documents" placeholder="è«‹åˆ—å‡ºç›¸é—œæ–‡ä»¶æ¸…å–®..." oninput="autoResize(this)"></textarea>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title">ä¸‰ã€å¾‹å¸«å›è¦†æ„è¦‹</h3>
                <div class="content-wrapper">
                    <textarea id="lawyerResponse" placeholder="è«‹åœ¨æ­¤è¼¸å…¥æ‚¨çš„å°ˆæ¥­æ³•å¾‹æ„è¦‹..." class="main-response" oninput="autoResize(this)"></textarea>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title">å››ã€æ³•ä»¤åŠå¥‘ç´„ä¾æ“š</h3>
                <div id="legalBasisContainer" class="content-wrapper">
                    <div class="legal-basis-row">
                        <div class="basis-col-title">
                            <input type="text" placeholder="ä¾‹ï¼šæ°‘æ³•ç¬¬179æ¢" class="basis-input-title">
                        </div>
                        <div class="basis-col-content">
                            <textarea placeholder="å…§å®¹..." oninput="autoResize(this)"></textarea>
                        </div>
                    </div>
                </div>
                <div class="content-wrapper">
                    <button type="button" class="btn-add no-print" onclick="addLegalBasis()">
                        <span class="icon">+</span> æ–°å¢æ³•æ¢
                    </button>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title">äº”ã€å…¶ä»–æ„è¦‹æˆ–å»ºè­°</h3>
                <div class="content-wrapper">
                    <textarea id="otherOpinions" placeholder="è‹¥ç„¡å‰‡ç•™ç©º..." oninput="autoResize(this)"></textarea>
                    
                    <div class="image-upload-area">
                        <p class="no-print upload-hint">ğŸ“ æ’å…¥æ³•å¾‹é—œä¿‚åœ–æˆ–é™„ä»¶åœ–ç‰‡ï¼š</p>
                        <input type="file" accept="image/*" class="no-print" onchange="previewImage(this)">
                        <div id="imagePreviewContainer" class="image-preview-box">
                            </div>
                    </div>
                </div>
            </div>
            
            <div class="footer-note">
                <p>æœ¬æ–‡ä»¶ç”±æ³•å¾‹é¡§å•ç³»çµ±ç”Ÿæˆï¼Œåƒ…ä¾›è«®è©¢åƒè€ƒï¼Œå…·é«”è¨´è¨Ÿç­–ç•¥è«‹ä¾æ­£å¼å§”ä»»ç‚ºæº–ã€‚</p>
            </div>
        </form>
    </div>
</div>

<div class="action-bar no-print">
    <button onclick="handlePrint()" class="btn-primary">
        åˆ—å° / å­˜ç‚º PDF
    </button>
    <button onclick="handleShare()" class="btn-secondary">
        åˆ†äº«æ–‡å­—
    </button>
</div>

<script src="script.js"></script>
<script>
    if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
</script>
</body>
</html>